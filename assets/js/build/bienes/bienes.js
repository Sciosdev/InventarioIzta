import{spinner,crearFormulario,mostrarTabla,crearScrollableModal,mostrarAlerta,consultarSelect,eventoFiltro,guardar,eliminar,llenarFormulario,abrirModalConsultaBienes,llenarSelect,validarVarios}from"../funciones.js";import{getApiFiltros}from"../api/funcionesApi.js";import{filtros,datos,divTabla,nombreTabla,btnConsultar,btnLimpiar,btnConsultarVarios,btnNuevo,btnEditar,btnEliminar,inputsFiltros,selects,dato_Editar}from"../variables.js";consultarSelect(selects),inputsFiltros.forEach((e=>{eventoFiltro(e)})),btnConsultar.addEventListener("click",(async function(){spinner(divTabla),datos.value=await getApiFiltros(nombreTabla,filtros.value),console.log("datos.value tras getApiFiltros:",datos.value),sessionStorage.setItem("bienes_imprimir",JSON.stringify(datos.value)),console.log("✅ sessionStorage.bienes_imprimir:",JSON.parse(sessionStorage.getItem("bienes_imprimir"))),mostrarTabla(nombreTabla,!0,null)})),btnLimpiar.addEventListener("click",(function(){document.querySelector(".filtros").reset(),filtros.value={}})),btnConsultarVarios.addEventListener("click",(function(){abrirModalConsultaBienes()})),btnNuevo.addEventListener("click",(function(){const e=crearFormulario("bienes");crearScrollableModal("scrollable-modal","Crear",e.outerHTML);const r=document.querySelectorAll(".formulario select:not(#tipo_inventario):not(#transferido)");llenarSelect(r),guardar()})),btnEditar.addEventListener("click",(function(){if(0===dato_Editar.size)return void mostrarAlerta("warning","Alerta","Por favor, selecciona un registro antes de continuar");const e=1!==dato_Editar.size?crearFormulario("editarBienes"):crearFormulario(nombreTabla,dato_Editar.values().next().value);crearScrollableModal("scrollable-modal","Editar Bien(es)",e.outerHTML);const r=1!==dato_Editar.size?document.querySelectorAll(".formulario select#areas, .formulario select#responsables"):document.querySelectorAll(".formulario select:not(#tipo_inventario):not(#transferido)");llenarSelect(r),1===dato_Editar.size?(llenarFormulario(dato_Editar.values().next().value),guardar()):dato_Editar.size>1&&validarVarios()})),btnEliminar.addEventListener("click",(async function(){if(1!==dato_Editar.size){const e=0===dato_Editar.size?"Por favor, selecciona un registro antes de continuar":"No es posible eliminar más de un registro a la vez.";return void mostrarAlerta("warning","Alerta",e)}const e=document.createElement("P");e.classList.add("text-center","fs-4"),e.textContent="¿Estás seguro de que deseas eliminar este registro?",crearScrollableModal("scrollable-modal","Eliminar",e.outerHTML,"confirmar"),document.querySelector(".confirmar").addEventListener("click",eliminar)}));